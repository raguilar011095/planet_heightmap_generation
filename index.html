<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>World Orogen</title>
    <meta name="description" content="Generate planets shaped by tectonics, erosion, and volcanism - free, in your browser.">
    <meta property="og:type" content="website">
    <meta property="og:title" content="World Orogen">
    <meta property="og:description" content="Generate planets shaped by tectonics, erosion, and volcanism - free, in your browser.">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="World Orogen">
    <meta name="twitter:description" content="Generate planets shaped by tectonics, erosion, and volcanism - free, in your browser.">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text x='50' y='50' dominant-baseline='central' text-anchor='middle' font-size='75'>üåç</text></svg>">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="buildOverlay" class="build-overlay initial">
        <div class="build-overlay-inner">
            <div class="build-overlay-spinner"></div>
            <div class="build-overlay-title">World Orogen</div>
            <div class="progress-bar-container">
                <div class="progress-bar-fill" id="buildBarFill"></div>
            </div>
            <div class="progress-label" id="buildBarLabel"></div>
        </div>
    </div>
    <canvas id="canvas"></canvas>
    <div id="ui">
        <div id="sheetHandle" class="sheet-handle"><span></span></div>
        <div id="sidebarHeader">
            <div>
                <h2>World Orogen</h2>
                <div class="sub">Build worlds shaped by tectonic forces</div>
            </div>
            <button id="sidebarToggle" title="Collapse panel">&#x00AB;</button>
        </div>
        <div id="sidebarContent">
        <details class="section" open>
            <summary>Shape Your World</summary>
            <div class="section-body">
                <div class="cg">
                    <label>Detail <span class="tip" data-tip="Resolution of the sphere ‚Äî more detail means finer coastlines and terrain, but takes longer to generate">?</span> <span class="v" id="vN">201,000</span></label>
                    <input type="range" id="sN" min="0" max="1000" step="1" value="600">
                    <div class="slider-hint"><span>Coarse</span><span>Fine</span></div>
                    <div class="detail-warn" id="detailWarn"></div>
                </div>
                <div class="cg">
                    <label>Irregularity <span class="tip" data-tip="How randomly the cell points are scattered ‚Äî 0 gives a uniform grid, 1 gives fully organic, irregular shapes">?</span> <span class="v" id="vJ">0.75</span></label>
                    <input type="range" id="sJ" min="0" max="1" value="0.75" step="0.05">
                    <div class="slider-hint"><span>Uniform</span><span>Scattered</span></div>
                </div>
                <div class="cg">
                    <label>Plates <span class="tip" data-tip="Number of tectonic plates ‚Äî more plates means more boundaries where mountains, trenches, and coastlines form">?</span> <span class="v" id="vP">80</span></label>
                    <input type="range" id="sP" min="4" max="120" value="80" step="1">
                    <div class="slider-hint"><span>Few</span><span>Many</span></div>
                </div>
                <div class="cg">
                    <label>Continents <span class="tip" data-tip="Target number of landmasses ‚Äî 1 creates a supercontinent, higher values scatter land into multiple continents and archipelagos">?</span> <span class="v" id="vCn">4</span></label>
                    <input type="range" id="sCn" min="1" max="10" value="4" step="1">
                    <div class="slider-hint"><span>Supercontinent</span><span>Archipelago</span></div>
                </div>
                <div class="cg">
                    <label>Roughness <span class="tip" data-tip="Terrain roughness ‚Äî higher values add more fractal detail to mountains and coastlines">?</span> <span class="v" id="vNs">0.40</span></label>
                    <input type="range" id="sNs" min="0" max="0.5" value="0.40" step="0.01">
                    <div class="slider-hint"><span>Smooth</span><span>Rugged</span></div>
                </div>
            </div>
        </details>
        <button id="generate">Build New World</button>
        <div id="seedRow">
            <input type="text" id="seedCode" placeholder="Planet code">
            <button id="copyBtn" title="Copy code">&#x2398;</button>
            <button id="loadBtn" title="Load planet from code">Load</button>
        </div>
        <div id="seedError">Invalid planet code</div>
        <details class="section">
            <summary>Terrain Sculpting <span class="tip" data-tip="Erosion and smoothing passes that refine the raw terrain. Adjust sliders and click Reapply ‚Äî no full rebuild needed.">?</span></summary>
            <div class="section-body">
                <div class="cg">
                    <label>Smoothing <span class="tip" data-tip="Blends harsh terrain boundaries from tectonic generation ‚Äî smooths banded ridges and abrupt transitions">?</span> <span class="v" id="vS">0.10</span></label>
                    <input type="range" id="sS" min="0" max="1" value="0.10" step="0.05">
                    <div class="slider-hint"><span>None</span><span>Heavy</span></div>
                </div>
                <div class="cg">
                    <label>Glacial Erosion <span class="tip" data-tip="Ice-age sculpting ‚Äî carves fjords, U-shaped valleys, and lake basins at high latitudes and altitudes">?</span> <span class="v" id="vGl">0.35</span></label>
                    <input type="range" id="sGl" min="0" max="1" value="0.35" step="0.05">
                    <div class="slider-hint"><span>None</span><span>Ice Age</span></div>
                </div>
                <div class="cg">
                    <label>Hydraulic Erosion <span class="tip" data-tip="Iterative stream-power erosion ‚Äî carves river valleys and dendritic drainage networks">?</span> <span class="v" id="vHEr">0.35</span></label>
                    <input type="range" id="sHEr" min="0" max="1" value="0.35" step="0.05">
                    <div class="slider-hint"><span>None</span><span>Deep</span></div>
                </div>
                <div class="cg">
                    <label>Thermal Erosion <span class="tip" data-tip="Slope-driven material transport ‚Äî softens ridges and creates natural talus slopes">?</span> <span class="v" id="vTEr">0.10</span></label>
                    <input type="range" id="sTEr" min="0" max="1" value="0.10" step="0.05">
                    <div class="slider-hint"><span>None</span><span>Heavy</span></div>
                </div>
                <div class="cg">
                    <label>Ridge Sharpening <span class="tip" data-tip="Accentuates mountain ridgelines ‚Äî pushes peaks further above their surroundings for more dramatic terrain">?</span> <span class="v" id="vRs">0.35</span></label>
                    <input type="range" id="sRs" min="0" max="1" value="0.35" step="0.05">
                    <div class="slider-hint"><span>None</span><span>Jagged</span></div>
                </div>
                <button id="reapplyBtn" title="Reapply terrain sculpting" disabled><span class="reapply-icon">&#x21bb;</span> Reapply</button>
            </div>
        </details>
        <details class="section" open>
            <summary>Visual Options</summary>
            <div class="section-body">
                <div class="cg">
                    <label>View</label>
                    <select id="viewMode">
                        <option value="globe">Globe</option>
                        <option value="map">Map</option>
                    </select>
                </div>
                <div class="tg">
                    <label><input type="checkbox" id="chkWire"> Wireframe</label>
                    <label><input type="checkbox" id="chkPlates"> Show Plates</label>
                    <label><input type="checkbox" id="chkRotate"> Auto-Rotate</label>
                    <label><input type="checkbox" id="chkGrid" checked> Grid Lines</label>
                </div>
                <div class="cg" id="gridSpacingGroup">
                    <label>Grid Spacing</label>
                    <select id="gridSpacing">
                        <option value="30">30¬∞</option>
                        <option value="15" selected>15¬∞</option>
                        <option value="10">10¬∞</option>
                        <option value="5">5¬∞</option>
                        <option value="2.5">2.5¬∞</option>
                    </select>
                </div>
            </div>
        </details>
        <button id="exportBtn" class="export-btn">Export Map</button>
        <details class="section">
            <summary>Detailed Visualization</summary>
            <div class="section-body">
                <div class="cg">
                    <label>Inspect</label>
                    <select id="debugLayer">
                        <option value="">Terrain</option>
                        <option value="base">Base</option>
                        <option value="tectonic">Tectonic</option>
                        <option value="noise">Noise</option>
                        <option value="interior">Interior</option>
                        <option value="coastal">Coastal</option>
                        <option value="ocean">Ocean</option>
                        <option value="hotspot">Hotspot</option>
                        <option value="tecActivity">Tectonic Activity</option>
                        <option value="margins">Margins</option>
                        <option value="backArc">Back-Arc</option>
                        <option value="erosionDelta">Erosion Delta</option>
                        <option value="pressureSummer">Pressure (Summer)</option>
                        <option value="pressureWinter">Pressure (Winter)</option>
                        <option value="windSpeedSummer">Wind Speed (Summer)</option>
                        <option value="windSpeedWinter">Wind Speed (Winter)</option>
                        <option value="oceanCurrentSummer">Ocean Currents (Summer)</option>
                        <option value="oceanCurrentWinter">Ocean Currents (Winter)</option>
                        <option value="precipSummer">Precipitation (Summer)</option>
                        <option value="precipWinter">Precipitation (Winter)</option>
                        <option value="tempSummer">Temperature (Summer)</option>
                        <option value="tempWinter">Temperature (Winter)</option>
                        <option value="heightmap">Heightmap</option>
                        <option value="landheightmap">Land Heightmap</option>
                    </select>
                </div>
                <div id="stats"></div>
            </div>
        </details>
        <a id="repoLink" href="https://github.com/raguilar011095/planet_heightmap_generation" target="_blank" rel="noopener">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82a7.64 7.64 0 0 1 4 0c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.01 8.01 0 0 0 16 8c0-4.42-3.58-8-8-8z"/></svg>
            GitHub
        </a>
        </div>
    </div>
    <button id="helpBtn" title="Tutorial">?</button>

    <div id="tutorialOverlay" class="hidden">
        <div id="tutorialCard">
            <button id="tutorialClose">&times;</button>
            <div class="tutorial-step" data-step="0">
                <h3>Welcome to World Orogen</h3>
                <p>The world's most realistic-ish planet generator.</p>
                <p>Generate unique procedural planets shaped by tectonic forces. Every world is one of a kind ‚Äî with realistic continents, mountains, ocean trenches, and volcanic islands.</p>
            </div>
            <div class="tutorial-step" data-step="1">
                <h3>Shape Your World</h3>
                <p>Use the <strong>Shape Your World</strong> sliders to control detail, plates, continents, and roughness, then hit <strong>Build New World</strong>. Expand <strong>Terrain Sculpting</strong> to fine-tune erosion and smoothing &mdash; these can be reapplied instantly with the <strong>&#x21bb;</strong> button.</p>
            </div>
            <div class="tutorial-step" data-step="2">
                <h3>Explore &amp; Edit</h3>
                <p><strong>Drag</strong> to rotate the globe. <strong>Scroll</strong> to zoom in and out. <strong>Ctrl-click</strong> any plate to reshape continents &mdash; ocean rises into land, land floods into ocean.</p>
            </div>
            <div class="tutorial-step" data-step="3">
                <h3>Save &amp; Share</h3>
                <p>Every planet gets a unique <strong>planet code</strong> shown below the Build button &mdash; including any plates you've edited. <strong>Copy</strong> it to share with others, or <strong>paste</strong> a code and click <strong>Load</strong> to recreate someone else's world. You can also share the URL directly.</p>
                <p>Use <strong>Export Map</strong> to download high-resolution equirectangular images &mdash; full-color terrain or black-and-white heightmaps.</p>
            </div>
            <div class="tutorial-dots">
                <span class="dot active" data-dot="0"></span>
                <span class="dot" data-dot="1"></span>
                <span class="dot" data-dot="2"></span>
                <span class="dot" data-dot="3"></span>
            </div>
            <div class="tutorial-nav">
                <button id="tutorialBack" class="btn-ghost" disabled>Back</button>
                <button id="tutorialNext" class="btn-primary">Next</button>
            </div>
        </div>
    </div>

    <div id="exportOverlay" class="hidden">
        <div id="exportCard">
            <button id="exportClose">&times;</button>
            <h3>Export Map</h3>
            <div class="cg">
                <label>Type</label>
                <select id="exportType">
                    <option value="color">Color Map</option>
                    <option value="heightmap">Heightmap (B&amp;W)</option>
                    <option value="landheightmap">Land Heightmap (B&amp;W)</option>
                </select>
            </div>
            <div class="cg">
                <label>Width <span class="v" id="exportDims">4096 &times; 2048</span></label>
                <select id="exportWidth">
                    <option value="1024">1024</option>
                    <option value="2048">2048</option>
                    <option value="4096" selected>4096</option>
                    <option value="8192">8192</option>
                    <option value="16384">16384</option>
                    <option value="32768">32768</option>
                    <option value="65536">65536</option>
                </select>
            </div>
            <div class="export-actions">
                <button id="exportCancel" class="btn-ghost">Cancel</button>
                <button id="exportGo" class="btn-primary">Export</button>
            </div>
        </div>
    </div>

    <div id="surveyOverlay" class="hidden">
        <div id="surveyCard">
            <button id="surveyClose">&times;</button>
            <h3>Thanks for exploring!</h3>
            <p>You've spent some real time with World Orogen &mdash; that means a lot. If you have a minute, I'd love to hear what you think.</p>
            <div class="survey-actions">
                <button id="surveyDismiss" class="btn-ghost">Maybe later</button>
                <a id="surveyLink" href="https://docs.google.com/forms/d/e/1FAIpQLScFSryT8Uom4jMkpb-YQnyjHMSWqZmDDT3bSOSabHovsjKL7A/viewform?usp=dialog" target="_blank" rel="noopener" class="btn-primary">Take the survey</a>
            </div>
        </div>
    </div>

    <div id="topInfo">Drag to rotate &middot; Scroll to zoom &middot; Ctrl-click to reshape continents</div>
    <button id="editToggle" class="edit-toggle" title="Toggle plate edit mode">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14.5 2.5l3 3L6 17H3v-3L14.5 2.5z"/>
        </svg>
    </button>
    <button id="refreshFab" class="refresh-fab" title="Generate new planet">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M17 10a7 7 0 1 1-2-5"/>
            <polyline points="15 2 17 5 14 6"/>
        </svg>
    </button>
    <div id="hoverInfo"></div>
    <div id="info">Drag to rotate &middot; Scroll to zoom &middot; Ctrl-click to reshape continents</div>

    <script type="importmap">
    {
        "imports": {
            "three": "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js",
            "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/",
            "delaunator": "https://cdn.jsdelivr.net/npm/delaunator@5.0.1/+esm"
        }
    }
    </script>

    <script type="module" src="js/main.js"></script>
</body>
</html>
